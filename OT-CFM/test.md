下面先给出**Top-k 子空间相似性搜索算法**的详细步骤描述，随后是一段针对该实验的**精准简介**。

---

## 算法描述

设在第 $t$ 时刻，计算得到 $n$ 维 Hessian 矩阵 $\mathbf{H}_t$，其按特征值大小（绝对值或代价敏感顺序）降序排列的正交归一化特征向量矩阵为

$$
\mathbf{V}_t = [\mathbf{v}_{t,1}, \mathbf{v}_{t,2}, \dots, \mathbf{v}_{t,n}] \in \mathbb{R}^{n\times n}.
$$

记 $\mathbf{V}_t^{(k)} = [\mathbf{v}_{t,1}, \dots, \mathbf{v}_{t,k}]$ 为其前 $k$ 个特征向量构成的子空间基。

给定相似度阈值 $\tau\in(0,1]$，算法目标是在时间序列 $\{\mathbf{H}_1,\mathbf{H}_2,\dots,\mathbf{H}_T\}$ 上，寻找最大的 $k$，使得对所有相邻时刻 $t$ 与 $t+1$，子空间 $\operatorname{span}(\mathbf{V}_t^{(k)})$ 与 $\operatorname{span}(\mathbf{V}_{t+1}^{(k)})$ 的最小奇异值均不低于 $\tau$。

具体步骤：

1. **初始化**

   * 设 $k_{\max} = n$，将搜索起点 $k \leftarrow k_{\max}$。

2. **对子空间相似度的度量**

   * 对任意给定 $k$，定义子空间相似度

     $$
       \sigma_{\min}^{(t)}(k) = \min\!\bigl(\mathrm{singular\_values}(\,(\mathbf{V}_t^{(k)})^\top \,\mathbf{V}_{t+1}^{(k)} )\bigr),
     $$

     其中 $\sigma_{\min}^{(t)}(k)\in[0,1]$。

3. **逐步验证相似性**

   * 对所有 $t = 1,2,\dots,T-1$：

     1. 计算矩阵 $\mathbf{M}_t = (\mathbf{V}_t^{(k)})^\top \,\mathbf{V}_{t+1}^{(k)}$。
     2. 对 $\mathbf{M}_t$ 做 SVD：
        $\mathbf{M}_t = \mathbf{U}_t\,\mathbf{\Sigma}_t\,\mathbf{W}_t^\top$，其中 $\mathbf{\Sigma}_t = \mathrm{diag}(\sigma_1^{(t)},\dots,\sigma_k^{(t)})$，记 $\sigma_{\min}^{(t)} = \sigma_k^{(t)}$。
     3. 若对任意 $t$ 有 $\sigma_{\min}^{(t)} < \tau$，则认为当前 $k$ 不满足要求，终止对该 $k$ 的验证。

4. **调整 $k$**

   * 若所有 $\sigma_{\min}^{(t)} \ge \tau$，则当前 $k$ 合格；算法结束，输出该最大 $k$。
   * 否则，将 $k \leftarrow k - 1$，返回步骤 3，直到 $k=0$ 停止（若 $k=0$ 仍不满足，则无任何非零维度子空间保持相似性）。

5.（可选）**二分加速**

* 如需加速，可将上述线性搜索改为二分搜索：维护区间 $[\ell,u]$，初始 $[\ell=0,u=n]$，反复取中点 $k = \lfloor(\ell+u)/2\rfloor$，测试相似性，若满足则 $\ell=k$，否则 $u=k$，直至收敛。

---

## 实验简介

> 本实验旨在量化深度模型训练过程中，高维 Hessian 矩阵主特征子空间的演化稳定性。具体地，我们首先在连续训练步骤 $t=1,2,\dots,T$ 上，分别对模型损失函数的 Hessian 矩阵 $\mathbf{H}_t$ 进行特征分解，提取其按特征值排序的前 $k$ 个正交归一化特征向量子空间。随后，基于奇异值分解（SVD）技术，我们评估相邻时刻子空间 $\operatorname{span}(\mathbf{V}_t^{(k)})$ 与 $\operatorname{span}(\mathbf{V}_{t+1}^{(k)})$ 的最小奇异值作为相似度度量。通过逐步减小或二分搜索的方式，找到全序列中最大的 $k$ 使得每一对相邻子空间的相似度均不低于预定阈值 $\tau$。该方法能够揭示在训练动态下，模型在参数空间中最具代表性的方向（前 $k$ 个特征向量）是否保持稳定，为理解训练过程中的低维结构演化提供量化依据。实验将在经典图像分类（如 CIFAR-10/100）及语言模型微调场景中进行，并考察不同优化器（SGD、Adam）和学习率策略下的子空间稳定性差异。


当然，以下是删去微调与应用场景后的、仅聚焦算法本身的**修改后的实验简介**：

---

## 实验简介

本实验旨在探究模型训练过程中，不同时刻的 Hessian 矩阵前 Top‑k 特征子空间之间的稳定性。具体地，我们在每个时间步提取对应 Hessian 的前 $k$ 个正交归一化特征向量，并构造其所张成的子空间。通过对相邻两个时间步的子空间进行奇异值分解（SVD），我们计算子空间间投影矩阵的最小奇异值作为相似度指标。当该最小奇异值大于设定阈值 $\tau$ 时，认为两个子空间相似。我们设计了一种递减搜索算法，从最大的 $k=n$ 开始逐步减小维度，直到找到一个最大的 $k$，使得在所有连续时间步中，前 $k$ 维特征子空间始终保持高相似度（即最小奇异值不低于阈值）。该算法可以有效刻画训练过程中 Hessian 主方向所构成的子空间在时间维度上的稳定性，为理解模型参数动态中的结构性提供了新的视角与度量手段。

感谢指正，确实如此：你所定义的 $\mathbf{P}$ 是一个**加权曲率矩阵**，形式为

$$
\mathbf{P}_K^{(t+1)} = \sum_{i=1}^K \lambda_i^{(t+1)} \mathbf{v}_i^{(t+1)} (\mathbf{v}_i^{(t+1)})^\top,
$$

而非普通的投影矩阵。

以下是**修正后的实验简介**，正确使用了加权曲率矩阵并保持欧几里得范数度量：

---

## 实验简介（最大曲率方向在下一步加权曲率子空间中的保持程度分析）

本实验旨在研究模型训练过程中 Hessian 最大特征方向在时间维度上的保持程度。具体地，在每个时间步 $t$，我们提取 Hessian 矩阵的最大特征向量 $\mathbf{v}_1^{(t)}$。在随后的时间步 $t+1$，我们利用该步 Hessian 的前 $K$ 个特征值 $\{\lambda_i^{(t+1)}\}_{i=1}^K$ 与对应的正交归一特征向量 $\{\mathbf{v}_i^{(t+1)}\}_{i=1}^K$，构造加权曲率矩阵：

$$
\mathbf{P}_K^{(t+1)} = \sum_{i=1}^K \lambda_i^{(t+1)} \mathbf{v}_i^{(t+1)} (\mathbf{v}_i^{(t+1)})^\top.
$$

我们计算第 $t$ 步的最大特征方向 $\mathbf{v}_1^{(t)}$ 在该加权子空间上的响应强度，定义如下归一化投影值：

$$
r^{(t)} = \frac{\left\| \mathbf{P}_K^{(t+1)} \mathbf{v}_1^{(t)} \right\|_2}{\left\| \mathbf{v}_1^{(t)} \right\|_2}.
$$

该比值 $r^{(t)} \in [0, +\infty)$ 可视为曲率主子空间对上一时间步主方向的“保持能力”，数值越大表示该方向在新的局部几何中仍具有显著曲率响应。通过沿时间轴跟踪该指标，我们可以揭示训练过程中主曲率方向的动态演化与保留情况，为深入理解优化轨迹与损失地形结构的协同变化提供实证依据。

